<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shabak Bot - Verify UID</title>
    <style>
        /* Base styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0c1e3a; /* Dark blue background */
            color: #ffffff; /* White text */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start; /* Align to top for mini-app feel */
            min-height: 100vh; /* Full viewport height */
            margin: 0;
            overflow-x: hidden; /* Prevent horizontal scroll */
            padding: 0; /* Remove default body padding */
        }

        /* Repeating background pattern of pickaxes and gems */
        .background-pattern {
            position: fixed; /* Fixed to viewport for consistent background */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.1; /* Subtle overlay */
            background-image: url("data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%239CA3AF' fill-opacity='0.2'%3E%3Cpath d='M0 0h20v20H0zM20 20h20v20H20z'/%3E%3Cpath d='M10 0h10v10H10zM0 10h10v10H0zM30 0h10v10H30zM20 10h10v10H20zM10 20h10v10H10zM0 30h10v10H0zM30 20h10v10H30zM20 30h10v10H20z'/%3E%3Cpath d='M15 5h10v10H15zM5 15h10v10H5zM35 5h10v10H35zM25 15h10v10H25zM15 25h10v10H15zM5 35h10v10H5zM35 25h10v10H35zM25 35h10v10H25z'/%3E%3Cpath d='M5 5h10v10H5zM15 15h10v10H15zM25 5h10v10H25zM5 25h10v10H5zM15 35h10v10H15zM25 15h10v10H25zM35 25h10v10H35zM35 35h10v10H35z'/%3E%3C/g%3E%3C/svg%3E");
            background-size: 40px 40px;
            z-index: -1; /* Ensure it stays behind content */
        }

        /* Main container for the app */
        .app-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            min-height: 100vh;
            padding: 0;
        }

        /* Application Card */
        .app-card {
            background-color: #1a365d; /* bg-blue-900 */
            border-bottom: 1px solid #2a5286; /* border-b border-blue-700 */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); /* shadow-2xl */
            overflow: hidden;
            width: 100%; /* w-full */
        }

        /* Header */
        .app-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem; /* p-4 */
            background-color: rgba(26, 54, 93, 0.7); /* bg-blue-800/70 */
            border-bottom: 1px solid #2a5286; /* border-b border-blue-700 */
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .header-button {
            color: #93c5fd; /* text-blue-300 */
            transition-property: color, background-color;
            transition-duration: 150ms;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); /* transition-colors */
            padding: 0.25rem; /* p-1 */
            border-radius: 9999px; /* rounded-full */
        }

        .header-button:hover {
            color: #ffffff; /* hover:text-white */
            background-color: #2a5286; /* hover:bg-blue-700 */
        }

        .header-icons {
            display: flex;
            gap: 0.75rem; /* space-x-3 */
        }

        .app-title {
            font-size: 1.25rem; /* text-xl */
            font-weight: 700; /* font-bold */
            color: #ffffff; /* text-white */
        }

        /* Main content area */
        .main-content {
            padding: 1.5rem; /* p-6 */
        }

        /* Input Section */
        .input-section h3 {
            font-size: 1.125rem; /* text-lg */
            font-weight: 600; /* font-semibold */
            margin-bottom: 1rem; /* mb-4 */
            text-align: center;
            color: #bfdbfe; /* text-blue-200 */
        }

        .uid-input {
            width: 100%;
            padding: 0.75rem; /* p-3 */
            border-radius: 0.5rem; /* rounded-lg */
            background-color: #2a5286; /* bg-blue-700 */
            color: #ffffff; /* text-white */
            text-align: center;
            border: 1px solid #254b7a; /* border border-blue-600 */
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06); /* shadow-inner */
            margin-bottom: 1.5rem; /* mb-6 */
        }

        .uid-input::placeholder {
            color: #93c5fd; /* placeholder-blue-300 */
        }

        .uid-input:focus {
            outline: none;
            box-shadow: 0 0 0 2px #60a5fa; /* focus:ring-2 focus:ring-blue-400 */
        }

        .verify-button {
            width: 100%;
            padding: 0.75rem 1.25rem; /* py-3 */
            border-radius: 0.5rem; /* rounded-lg */
            background-color: #2563eb; /* bg-blue-600 */
            color: white;
            font-weight: 700; /* font-bold */
            font-size: 1.125rem; /* text-lg */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); /* shadow-md */
            transition-property: background-color, transform;
            transition-duration: 150ms;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); /* transition-colors, transform */
            cursor: pointer;
        }

        .verify-button:hover {
            background-color: #1d4ed8; /* hover:bg-blue-700 */
            transform: scale(1.05); /* hover:scale-105 */
        }

        .verify-button:active {
            transform: scale(0.95); /* active:scale-95 */
        }

        .verify-button:focus {
            outline: none;
            box-shadow: 0 0 0 2px #60a5fa; /* focus:ring-2 focus:ring-blue-400 */
        }

        /* Verifying State */
        .verifying-section {
            text-align: center;
            padding: 1rem; /* p-4 */
        }

        .verifying-section svg {
            margin-left: auto;
            margin-right: auto;
            height: 4rem; /* h-16 */
            width: 4rem; /* w-16 */
            color: #60a5fa; /* text-blue-400 */
            animation: spin 1s linear infinite; /* animate-spin */
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .verifying-section p:first-of-type {
            font-size: 1.25rem; /* text-xl */
            font-weight: 600; /* font-semibold */
            margin-top: 1rem; /* mt-4 */
            color: #bfdbfe; /* text-blue-100 */
        }

        .verifying-section p:last-of-type {
            font-size: 0.875rem; /* text-sm */
            color: #93c5fd; /* text-blue-300 */
            margin-top: 0.5rem; /* mt-2 */
        }

        .verifying-section button {
            margin-top: 1.5rem; /* mt-6 */
            cursor: not-allowed;
            opacity: 0.7;
            background-color: #2a5286; /* bg-blue-700 */
        }

        /* Error State */
        .error-section {
            padding: 1rem; /* p-4 */
        }

        .error-message {
            display: flex;
            align-items: center;
            color: #f87171; /* text-red-400 */
            margin-bottom: 1rem; /* mb-4 */
        }

        .error-message svg {
            height: 1.75rem; /* h-7 */
            width: 1.75rem; /* w-7 */
            margin-right: 0.75rem; /* mr-3 */
            flex-shrink: 0;
        }

        .error-message p {
            font-weight: 600; /* font-semibold */
            font-size: 1.125rem; /* text-lg */
        }

        .error-list {
            list-style: none;
            padding: 0;
            margin-bottom: 1.5rem; /* mb-6 */
        }

        .error-list li {
            display: flex;
            align-items: flex-start;
            margin-bottom: 0.75rem; /* space-y-3 */
            font-size: 0.875rem; /* text-sm */
            color: #bfdbfe; /* text-blue-200 */
        }

        .error-list li span:first-child {
            margin-right: 0.5rem; /* mr-2 */
            color: #60a5fa; /* text-blue-400 */
            font-weight: 700; /* font-bold */
        }

        .error-list li a {
            color: #60a5fa; /* text-blue-400 */
            font-weight: 500; /* font-medium */
            text-decoration: none;
        }

        .error-list li a:hover {
            text-decoration: underline;
        }

        .note-text {
            font-size: 0.875rem; /* text-sm */
            color: #fcd34d; /* text-yellow-300 */
            margin-bottom: 0.5rem; /* mb-2 */
        }

        .note-text span {
            font-weight: 700; /* font-bold */
            margin-right: 0.25rem; /* mr-1 */
        }

        .email-link {
            color: #60a5fa; /* text-blue-400 */
            text-decoration: none;
            text-align: center;
            display: block;
            font-size: 1rem; /* text-base */
            font-weight: 500; /* font-medium */
        }

        .email-link:hover {
            text-decoration: underline;
        }

        /* Success State */
        .success-section {
            text-align: center;
            padding: 1rem; /* p-4 */
        }

        .success-section svg {
            margin-left: auto;
            margin-right: auto;
            height: 4rem; /* h-16 */
            width: 4rem; /* w-16 */
            color: #4ade80; /* text-green-400 */
        }

        .success-section p {
            font-size: 1.25rem; /* text-xl */
            font-weight: 600; /* font-semibold */
            margin-top: 1rem; /* mt-4 */
            color: #dcfce7; /* text-green-100 */
        }

        /* Footer */
        .app-footer {
            font-size: 0.75rem; /* text-xs */
            color: #93c5fd; /* text-blue-300 */
            padding: 0.75rem; /* py-3 */
            width: 100%;
            text-align: center;
            background-color: rgba(26, 54, 93, 0.7); /* bg-blue-900/70 */
            border-top: 1px solid #2a5286; /* border-t border-blue-700 */
            position: sticky;
            bottom: 0;
            z-index: 10;
        }

        /* Utility classes for showing/hiding sections */
        .hidden {
            display: none;
        }

        /* Media queries for responsiveness (sm: breakpoint equivalent) */
        @media (min-width: 640px) { /* Equivalent to Tailwind's sm breakpoint */
            .app-card {
                border-radius: 0.75rem; /* sm:rounded-xl */
                max-width: 28rem; /* sm:max-w-md (448px) */
                border: 1px solid #2a5286; /* sm:border */
            }

            .app-header {
                border-radius: 0.75rem 0.75rem 0 0; /* sm:rounded-t-xl */
            }

            .main-content {
                padding: 2rem; /* sm:p-8 */
            }
        }
    </style>
</head>
<body>
    <!-- Background pattern overlay -->
    <div class="background-pattern"></div>

    <!-- Main container for the app, adjusted for mini-app feel -->
    <div class="app-container">
        <!-- Application Card - now takes full width on small screens -->
        <div class="app-card">
            <!-- Header - fixed at the top for mini-app feel -->
            <div class="app-header">
                <button class="header-button">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                </button>
                <h1 class="app-title">Shabak Bot</h1>
                <div class="header-icons">
                    <button class="header-button">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z" />
                        </svg>
                    </button>
                    <button class="header-button">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Main content area, with more vertical padding for mini-app -->
            <div class="main-content">
                <!-- Input Section -->
                <div id="input-section" class="input-section">
                    <h3>Input Your BloFin User ID</h3>
                    <input type="text" id="uid-input" placeholder="Enter your user ID" class="uid-input">
                    <button id="verify-button" onclick="verifyUID()" class="verify-button">
                        Verify
                    </button>
                </div>

                <!-- Verifying State -->
                <div id="verifying-section" class="hidden verifying-section">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                    </svg>
                    <p>VERIFYING...</p>
                    <p>Please wait while we verify you. This might take a moment.</p>
                    <button class="verify-button" disabled>
                        Verifying...
                    </button>
                </div>

                <!-- Error State -->
                <div id="error-section" class="hidden error-section">
                    <div class="error-message">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2A9 9 0 111 10a9 9 0 0118 0z" />
                        </svg>
                        <p>Could not verify the provided UID with Shabak Bot referral link</p>
                    </div>
                    <ul class="error-list">
                        <li>
                            <span>1</span>
                            <span>Ensure that you have signed up using the <a href="https://partner.blofin.com/d/shabak" target="_blank">Shabak Bot Referral Link</a></span>
                        </li>
                        <li>
                            <span>2</span>
                            <span>Verify that you have entered the correct UID, which can be found on your profile page</span>
                        </li>
                    </ul>
                    <p class="note-text">
                        <span>!</span> NOTE: Once you have checked and are certain of the above conditions, please re-enter your Blofin UID.
                    </p>
                    <p class="note-text">
                        <span>!</span> Note: If the issue persists, please don't hesitate to reach out to us at
                    </p>
                    <a href="mailto:support@gemhunters.com" class="email-link">support@gemhunters.com</a>
                    <button onclick="resetUI()" class="verify-button" style="margin-top: 1.5rem;">
                        Try Again
                    </button>
                </div>

                <!-- Success State -->
                <div id="success-section" class="hidden success-section">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <p>✅ UID verified successfully!</p>
                    <button onclick="resetUI()" class="verify-button" style="margin-top: 1.5rem;">
                        Verify Another UID
                    </button>
                </div>
            </div>
        </div>

        <!-- Footer - fixed at the bottom for mini-app feel -->
        <div class="app-footer">
            @ShabakBot
        </div>
    </div>

    <script>
        // Function to show a specific section and hide others
        function showSection(sectionId) {
            const sections = ['input-section', 'verifying-section', 'error-section', 'success-section'];
            sections.forEach(id => {
                document.getElementById(id).classList.add('hidden');
            });
            document.getElementById(sectionId).classList.remove('hidden');
        }

        // Function to reset the UI to the initial input state
        function resetUI() {
            document.getElementById("uid-input").value = ""; // Clear input field
            showSection('input-section');
        }

        // Asynchronous function to handle UID verification
        async function verifyUID() {
            const uidInput = document.getElementById("uid-input");
            const uid = uidInput.value.trim();

            // Show the verifying state immediately
            showSection('verifying-section');

            try {
                // Make the API call to your backend
                const response = await fetch("https://telegrambot-production-a0ac.up.railway.app/verify", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ uid: uid }),
                });

                // Parse the JSON response
                const data = await response.json();

                // Check the 'found' status from the response
                if (data.found) {
                    showSection('success-section'); // Show success message
                } else {
                    showSection('error-section'); // Show error message
                }
            } catch (error) {
                // Log the error for debugging purposes
                console.error("Verification failed:", error);
                // Show the error message if the fetch operation fails
                showSection('error-section');
                // For this example, we'll use the existing error message structure.
            }
        }

        // Initialize the UI to the input section when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            showSection('input-section');
        });
    </script>
</body>
</html>
